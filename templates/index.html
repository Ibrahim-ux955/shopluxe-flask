{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
  <!-- Hero Banner -->
  <div class="d-flex flex-column flex-md-row align-items-center justify-content-between p-5 mb-5"
       style="background-color: #f8f9fa; border-radius: 10px; min-height: 300px;">
    <div class="text-center text-md-start mb-4 mb-md-0">
      <img src="{{ url_for('static', filename='logo/shopluxe.png') }}" alt="ShopLuxe Logo" style="height: 220px;">
    </div>
    <div class="text-center text-md-end p-4"
         style="background-color: black; color: white; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
      <h2 class="mb-2 text-white">Welcome to <span class="text-warning">ShopLuxe</span></h2>
      <p class="fs-5 mb-3 text-white">Luxury you can afford. Discover fashion, footwear & accessories.</p>
      <a href="{{ url_for('index') }}" class="btn btn-warning text-dark fw-bold px-4 py-2">Shop Now</a>
    </div>
  </div>

  <!-- Category Navigation Tabs -->
  <div class="d-flex justify-content-center flex-wrap mb-5">
    <a href="{{ url_for('filtered', category='All') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'All' %}active{% endif %}">All</a>
    <a href="{{ url_for('filtered', category='Shoes') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Shoes' %}active{% endif %}">Shoes</a>
    <a href="{{ url_for('filtered', category='Men') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Men' %}active{% endif %}">Men</a>
    <a href="{{ url_for('filtered', category='Women') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Women' %}active{% endif %}">Women</a>
    <a href="{{ url_for('filtered', category='Children') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Children' %}active{% endif %}">Children</a>
    <a href="{{ url_for('filtered', category='Watches') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Watches' %}active{% endif %}">Watches</a>
    <a href="{{ url_for('filtered', category='Jewelry') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Jewelry' %}active{% endif %}">Jewelry</a>
    <a href="{{ url_for('filtered', category='Accessories') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Accessories' %}active{% endif %}">Accessories</a>
    <a href="{{ url_for('filtered', category='Bags') }}" 
       class="btn btn-outline-dark m-2 {% if selected_category == 'Bags' %}active{% endif %}">Bag</a>
  </div>

  <!-- Featured Products -->
  <h4 class="mb-4 text-center text-dark">üî• Featured Products</h4>
  <div class="row">
    {% if featured_products %}
      {% for product in featured_products %}
      <div class="col-6 col-md-4 col-lg-3 mb-4 d-flex">
        <a href="{{ url_for('product_detail', product_id=product.id) }}" class="text-decoration-none flex-fill">
          <div class="card shadow-sm flex-fill text-center position-relative border-0">
            <img src="{{ url_for('static', filename='shoes/' + product.image) }}" 
                 alt="{{ product.name }}" 
                 class="img-fluid" 
                 style="width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:8px 8px 0 0;">

            {% if product.stock is defined %}
              {% if product.stock == 0 %}
                <span class="badge bg-danger position-absolute top-0 start-0 m-2">Out of Stock</span>
              {% elif product.stock <= 3 %}
                <span class="badge bg-warning text-dark position-absolute top-0 start-0 m-2">Low Stock</span>
              {% endif %}
            {% endif %}

            {% if product.timestamp is defined %}
              {% set product_time = product.timestamp|todatetime %}
              {% if product_time and (current_time - product_time).days <= 7 %}
                <span class="badge bg-success position-absolute top-0 end-0 m-2">New</span>
              {% endif %}
            {% endif %}

            {% if product.on_sale %}
              <span class="badge bg-danger position-absolute bottom-0 end-0 m-2">Sale</span>
            {% endif %}

            <div class="p-2 rounded-bottom" style="background-color: #f8f9fa;">
              <p class="mb-1 fw-semibold text-dark" style="font-size:15px;">{{ product.name }}</p>
              {% if product.on_sale and product.sale_price %}
  <p class="fw-bold mb-1 text-danger">
    GH‚Çµ {{ product.sale_price }}
    <span class="text-muted text-decoration-line-through ms-2" style="font-size: 14px;">
      GH‚Çµ {{ product.price }}
    </span>
  </p>
  <span class="badge bg-danger position-absolute bottom-0 end-0 m-2">Sale</span>
{% else %}
  <p class="fw-bold mb-1 text-dark">GH‚Çµ {{ product.price }}</p>
{% endif %}

              {% if product.description %}
                <p class="small mb-0 text-dark">{{ product.description[:50] }}{% if product.description|length > 50 %}...{% endif %}</p>
              {% endif %}
            </div>
          </div>
        </a>
      </div>
      {% endfor %}
    {% else %}
      <div class="col-12 text-center mt-5">
        <h5 class="text-dark">üö´ No featured products available right now.</h5>
      </div>
    {% endif %}
  </div>

  <!-- All Products -->
  <h4 class="mt-5 mb-4 text-center text-dark">üõçÔ∏è All Products</h4>
  <div class="row">
    {% if products %}
      {% for product in products %}
      <div class="col-6 col-md-4 col-lg-3 mb-4 d-flex">
        <a href="{{ url_for('product_detail', product_id=product.id) }}" class="text-decoration-none flex-fill">
          <div class="card shadow-sm flex-fill text-center position-relative border-0">
            <img src="{{ url_for('static', filename='shoes/' + product.image) }}" 
                 alt="{{ product.name }}" 
                 class="img-fluid" 
                 style="width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:8px 8px 0 0;">

            {% if product.stock is defined %}
              {% if product.stock == 0 %}
                <span class="badge bg-danger position-absolute top-0 start-0 m-2">Out of Stock</span>
              {% elif product.stock <= 3 %}
                <span class="badge bg-warning text-dark position-absolute top-0 start-0 m-2">Low Stock</span>
              {% endif %}
            {% endif %}

            {% if product.timestamp is defined %}
              {% set product_time = product.timestamp|todatetime %}
              {% if product_time and (current_time - product_time).days <= 7 %}
                <span class="badge bg-success position-absolute top-0 end-0 m-2">New</span>
              {% endif %}
            {% endif %}

            {% if product.on_sale %}
              <span class="badge bg-danger position-absolute bottom-0 end-0 m-2">Sale</span>
            {% endif %}

            <div class="p-2 rounded-bottom" style="background-color: #f8f9fa;">
              <p class="mb-1 fw-semibold text-dark" style="font-size:15px;">{{ product.name }}</p>
              <p class="fw-bold mb-1 text-dark">GH‚Çµ {{ product.price }}</p>
              {% if product.description %}
                <p class="small mb-0 text-dark">{{ product.description[:50] }}{% if product.description|length > 50 %}...{% endif %}</p>
              {% endif %}
            </div>
          </div>
        </a>
      </div>
      {% endfor %}
    {% else %}
      <div class="col-12 text-center mt-5">
        <h5 class="text-dark">üö´ Sorry, no products found.</h5>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
